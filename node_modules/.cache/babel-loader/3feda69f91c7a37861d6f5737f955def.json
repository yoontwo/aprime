{"ast":null,"code":"var _excluded = [\"a11yTitle\", \"axis\", \"bounds\", \"chart\", \"data\", \"detail\", \"gap\", \"guide\", \"legend\", \"pad\", \"series\", \"size\"],\n    _excluded2 = [\"property\", \"type\", \"x\", \"y\"];\n\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nimport React, { forwardRef, useContext, useMemo, useRef, useState } from 'react';\nimport { ThemeContext } from 'styled-components';\nimport { useLayoutEffect } from '../../utils/use-isomorphic-layout-effect';\nimport { Box } from '../Box';\nimport { Chart, calcs, calcBounds } from '../Chart';\nimport { Grid } from '../Grid';\nimport { Stack } from '../Stack';\nimport { parseMetricToNum } from '../../utils';\nimport { Detail } from './Detail';\nimport { Legend } from './Legend';\nimport { XAxis } from './XAxis';\nimport { YAxis } from './YAxis';\nimport { XGuide } from './XGuide';\nimport { YGuide } from './YGuide';\nimport { createDateFormat, halfPad, heightYGranularity, points } from './utils';\nimport { DataChartPropTypes } from './propTypes'; // DataChart takes a generic data array of objects plus as few properties\n// as possible, and creates a Stack of Charts with x and y axes, a legend,\n// and interactive detail.\n// Much of the code here-in involves the \"few properties\" aspect where we\n// normalize and automatically handle whatever the caller didn't specify.\n\nvar DataChart = /*#__PURE__*/forwardRef(function (_ref, ref) {\n  var a11yTitle = _ref.a11yTitle,\n      _ref$axis = _ref.axis,\n      axisProp = _ref$axis === void 0 ? true : _ref$axis,\n      _ref$bounds = _ref.bounds,\n      boundsProp = _ref$bounds === void 0 ? 'align' : _ref$bounds,\n      chart = _ref.chart,\n      _ref$data = _ref.data,\n      data = _ref$data === void 0 ? [] : _ref$data,\n      detail = _ref.detail,\n      _ref$gap = _ref.gap,\n      gap = _ref$gap === void 0 ? 'small' : _ref$gap,\n      guideProp = _ref.guide,\n      legend = _ref.legend,\n      padProp = _ref.pad,\n      seriesProp = _ref.series,\n      size = _ref.size,\n      rest = _objectWithoutPropertiesLoose(_ref, _excluded);\n\n  var theme = useContext(ThemeContext) || defaultProps.theme; // legend interaction, if any\n\n  var _useState = useState(),\n      activeProperty = _useState[0],\n      setActiveProperty = _useState[1]; // refs used for ie11 not having Grid\n\n\n  var xRef = useRef();\n  var spacerRef = useRef(); // normalize seriesProp to an array of objects, one per property\n\n  var series = useMemo(function () {\n    if (Array.isArray(seriesProp)) return seriesProp.filter(function (s) {\n      return s.property || typeof s === 'string';\n    }).map(function (s) {\n      return typeof s === 'string' ? {\n        property: s\n      } : s;\n    });\n    if (typeof seriesProp === 'string') return [{\n      property: seriesProp\n    }];\n    if (seriesProp) return [seriesProp];\n    return [];\n  }, [seriesProp]);\n\n  var getPropertySeries = function getPropertySeries(prop) {\n    return series.find(function (_ref2) {\n      var property = _ref2.property;\n      return prop === property;\n    });\n  }; // Normalize chart to an array of objects.\n  // Each chart has one or more properties associated with it.\n  // A stacked bar chart has an array of properties.\n  // A point chart can have x, y, thickness, and color each driven\n  // by a separate property.\n\n\n  var charts = useMemo(function () {\n    if (!chart) {\n      if (series.length === 1) return series.filter(function (s) {\n        return s.property;\n      }).map(function (s) {\n        return {\n          property: s.property\n        };\n      }); // if we have more than one property, we'll use the first for\n      // the x-axis and we'll plot the rest\n\n      return series.slice(1).map(function (s) {\n        return {\n          property: s.property\n        };\n      });\n    }\n\n    if (Array.isArray(chart)) return chart.map(function (c) {\n      return typeof c === 'string' ? {\n        property: c\n      } : c;\n    }).filter(function (_ref3) {\n      var property = _ref3.property;\n      return property;\n    });\n    if (typeof chart === 'string') return [{\n      property: chart\n    }];\n    if (chart) return [chart];\n    return [];\n  }, [chart, series]); // map the series property values into their own arrays\n\n  var seriesValues = useMemo(function () {\n    var result = {};\n    series.forEach(function (_ref4) {\n      var property = _ref4.property;\n      result[property] = data.map(function (d) {\n        return d[property];\n      });\n    });\n    return result;\n  }, [data, series]); // Setup the values property for each chart.\n  // The index into 'charts' can be used to index into 'chartValues'.\n\n  var chartValues = useMemo(function () {\n    return charts.map(function (_ref5) {\n      var opacity = _ref5.opacity,\n          property = _ref5.property,\n          type = _ref5.type;\n\n      if (property) {\n        if (Array.isArray(property)) {\n          // A range chart or a stacked bar chart have multiple properties.\n          // In this case, this returns an array of values,\n          // one per property.\n          if (type === 'bars') {\n            // Further down, where we render, each property is rendered\n            // using a separate Chart component and the values are stacked\n            // such that they line up appropriately.\n            var totals = [];\n            return property.map(function (cp) {\n              // handle object or string\n              var aProperty = cp.property || cp;\n              var values = seriesValues[aProperty];\n              if (!values) return undefined; // property name isn't valid\n\n              return values.map(function (v, i) {\n                var base = totals[i] || 0;\n                totals[i] = base + v;\n                return [i, base, base + v];\n              });\n            });\n          }\n\n          return data.map(function (_, index) {\n            return [index].concat(property.map(function (p) {\n              return seriesValues[p] ? seriesValues[p][index] : data[index][p];\n            }));\n          });\n        }\n\n        if (typeof property === 'object') {\n          // When 'property' is an array, the keys of this array indicate\n          // which property drives which part of the rendered Chart.\n          var color = property.color,\n              thickness = property.thickness,\n              x = property.x,\n              y = property.y,\n              y2 = property.y2;\n          return seriesValues[x].map(function (value, index) {\n            var aValue = {\n              value: [value]\n            };\n            aValue.value.push(seriesValues[y][index]);\n            if (y2) aValue.value.push(seriesValues[y2][index]);\n\n            if (thickness) {\n              var t = seriesValues[thickness.property || thickness][index];\n              aValue.thickness = thickness.transform ? thickness.transform(t) : t;\n            }\n\n            if (color) {\n              var c = seriesValues[color.property || color][index];\n              aValue.color = color.transform ? color.transform(c) : c;\n            }\n\n            if (opacity) aValue.opacity = opacity;\n            return aValue;\n          });\n        }\n\n        return seriesValues[property];\n      }\n\n      return undefined;\n    });\n  }, [charts, data, seriesValues]); // map granularities to work well with the number of data points we have\n\n  var granularities = useMemo(function () {\n    var medium; // determine a good medium granularity that will align well with the\n    // length of the data\n\n    var steps = data.length - 1; // special case property driven point charts\n\n    if (charts[0] && typeof charts[0].property === 'object') medium = 3;else if (steps < 4) medium = data.length;else if (steps === 4) medium = 3;else if (steps % 4 === 0) medium = 5;else if (steps % 3 === 0) medium = 4;else if (steps % 2 === 0) medium = 3;else medium = 2;\n    return {\n      x: {\n        coarse: 2,\n        fine: data.length,\n        medium: medium\n      },\n      y: _extends({}, heightYGranularity[size && size.height || 'small'] || {\n        fine: 5,\n        medium: 3\n      }, {\n        coarse: 2\n      })\n    };\n  }, [charts, data.length, size]); // normalize axis to objects, convert granularity to a number\n\n  var axis = useMemo(function () {\n    if (!axisProp) return undefined;\n    var result = {};\n    if (axisProp === true || axisProp.x === true) result.x = {};\n    if (axisProp === true || axisProp.y === true) result.y = {};\n    if (!result.x && axisProp.x) result.x = typeof axisProp.x === 'string' ? {\n      property: axisProp.x\n    } : _extends({}, axisProp.x);\n    if (!result.y && axisProp.y) result.y = typeof axisProp.y === 'string' ? {\n      property: axisProp.y\n    } : _extends({}, axisProp.y);\n\n    if (result.x) {\n      if (!result.x.property) {\n        // see if we have a point chart that has an x property\n        if (data && data[0]) {\n          if (data[0].date) result.x.property = 'date';else if (data[0].time) result.x.property = 'time';\n        }\n      }\n\n      if (!result.x.granularity) result.x.granularity = 'coarse';\n    }\n\n    if (result.y) {\n      if (!result.y.property && charts[0]) // see if we have a point chart that has an x property\n        result.y.property = charts[0].property.y || charts[0].property;\n      if (!result.y.granularity) result.y.granularity = 'coarse';\n    } // calculate number of entries based on granularity\n\n\n    if (result.x) {\n      var _result$x$granularity = result.x.granularity,\n          granularity = _result$x$granularity === void 0 ? 'coarse' : _result$x$granularity;\n      result.x.count = granularities.x[granularity];\n    }\n\n    if (result.y) {\n      var _result$y$granularity = result.y.granularity,\n          _granularity = _result$y$granularity === void 0 ? 'coarse' : _result$y$granularity;\n\n      result.y.count = granularities.y[_granularity];\n    }\n\n    return result;\n  }, [axisProp, data, charts, granularities]); // calculate axis, bounds, and thickness for each chart\n\n  var chartProps = useMemo(function () {\n    var steps = [];\n    var coarseness = [undefined, 5];\n\n    if (axis && axis.x) {\n      var _axis$x$granularity = axis.x.granularity,\n          granularity = _axis$x$granularity === void 0 ? 'coarse' : _axis$x$granularity;\n      steps[0] = granularities.x[granularity] - 1;\n    } else steps[0] = data.length - 1;\n\n    if (axis && axis.y) {\n      var _axis$y$granularity = axis.y.granularity,\n          _granularity2 = _axis$y$granularity === void 0 ? 'coarse' : _axis$y$granularity;\n\n      steps[1] = granularities.y[_granularity2] - 1;\n    } else steps[1] = 1;\n\n    var chartBounds = chartValues.map(function (_, index) {\n      if (charts[index].type === 'bars') {\n        // merge values for bars case\n        var mergedValues = chartValues[index][0].slice(0);\n        chartValues[index].slice(1).filter(function (values) {\n          return values;\n        }) // property name isn't valid\n        .forEach(function (values) {\n          mergedValues = mergedValues.map(function (__, i) {\n            return [i, Math.min(mergedValues[i][1], values[i][1]), Math.max(mergedValues[i][2], values[i][2])];\n          });\n        });\n        return calcBounds(mergedValues, {\n          coarseness: coarseness,\n          steps: steps\n        });\n      } // if this is a data driven x chart, set coarseness for x\n\n\n      return calcBounds(chartValues[index], {\n        coarseness: charts[index].property.x ? [5, 5] : coarseness,\n        steps: steps\n      });\n    });\n\n    if (boundsProp === 'align' && chartBounds.length) {\n      var alignedBounds = [].concat(chartBounds[0]);\n      chartBounds.forEach(function (bounds) {\n        alignedBounds[0][0] = Math.min(alignedBounds[0][0], bounds[0][0]);\n        alignedBounds[0][1] = Math.max(alignedBounds[0][1], bounds[0][1]);\n        alignedBounds[1][0] = Math.min(alignedBounds[1][0], bounds[1][0]);\n        alignedBounds[1][1] = Math.max(alignedBounds[1][1], bounds[1][1]);\n      });\n      chartBounds = chartBounds.map(function () {\n        return alignedBounds;\n      });\n    }\n\n    return chartValues.map(function (values, index) {\n      var calcValues = charts[index].type === 'bars' ? values[0] : values;\n      return calcs(calcValues, {\n        bounds: chartBounds[index],\n        steps: steps\n      });\n    });\n  }, [axis, boundsProp, charts, chartValues, data, granularities]); // normalize how we style data properties for use by Legend and Detail\n\n  var seriesStyles = useMemo(function () {\n    var result = {}; // start from what we were explicitly given\n\n    charts.forEach(function (_ref6, index) {\n      var color = _ref6.color,\n          point = _ref6.point,\n          property = _ref6.property,\n          thickness = _ref6.thickness,\n          type = _ref6.type;\n      var calcThickness = chartProps[index].thickness;\n\n      if (typeof property === 'object' && !Array.isArray(property)) {\n        // data driven point chart\n        Object.keys(property).forEach(function (aspect) {\n          var prop = property[aspect];\n          if (!result[prop.property || prop]) result[prop.property || prop] = {\n            aspect: aspect\n          };\n        });\n      } else {\n        var props = Array.isArray(property) ? property : [property];\n        props.forEach(function (prop) {\n          var p = prop.property || prop;\n          var pColor = prop.color || color;\n          if (!result[p]) result[p] = {};\n          if (pColor && !result[p].color) result[p].color = pColor;\n          if (point && !result[p].point) result[p].point = point;else if (type === 'point') result[p].point = false;\n          if ((thickness || calcThickness) && !result[p].thickness) result[p].thickness = thickness || calcThickness;\n        });\n      }\n    }); // set color for any non-aspect properties we don't have one for yet\n\n    var colorIndex = 0;\n    var pointIndex = 0;\n    Object.keys(result).forEach(function (key) {\n      var seriesStyle = result[key];\n\n      if (!seriesStyle.aspect && !seriesStyle.color) {\n        seriesStyle.color = \"graph-\" + colorIndex;\n        colorIndex += 1;\n      } // set opacity if it isn't set and this isn't the active property\n\n\n      if (activeProperty !== undefined && activeProperty !== key) {\n        seriesStyle.opacity = 'medium';\n      }\n\n      if (seriesStyle.point === false) {\n        seriesStyle.point = points[pointIndex];\n        pointIndex += 1;\n      }\n    });\n    return result;\n  }, [activeProperty, charts, chartProps]); // normalize guide\n\n  var guide = useMemo(function () {\n    if (!guideProp) return undefined;\n    var result;\n\n    if (guideProp === true) {\n      result = {\n        x: {},\n        y: {}\n      };\n    } else {\n      result = {};\n      if (guideProp.x) result.x = _extends({}, guideProp.x);\n      if (guideProp.y) result.y = _extends({}, guideProp.y);\n    } // set counts\n\n\n    if (result.x) {\n      // if no granularity and axis, align count with axis\n      if (!result.x.granularity && axis && axis.x) result.x.count = axis.x.count;\n      if (!result.x.count) result.x.count = granularities.x[result.x.granularity || 'coarse'];\n    }\n\n    if (result.y) {\n      // if no granularity and axis, align count with axis\n      if (!result.y.granularity && axis && axis.y) result.y.count = axis.y.count;\n      if (!result.y.count) result.y.count = granularities.y[result.y.granularity || 'coarse'];\n    }\n\n    return result;\n  }, [axis, granularities, guideProp]); // set the pad to half the thickness, based on the chart types\n\n  var pad = useMemo(function () {\n    if (padProp !== undefined) return padProp;\n    var result = {};\n    charts.forEach(function (_ref7, index) {\n      var type = _ref7.type;\n      var thickness = chartProps[index].thickness;\n      result.horizontal = halfPad[thickness];\n      if (type && type !== 'bar') result.vertical = halfPad[thickness];\n    });\n    return result;\n  }, [chartProps, charts, padProp]); // The thickness of the Detail segments. We need to convert to numbers\n  // to be able to compare across charts where some might be using T-shirt\n  // labels and others might be pixel values.\n\n  var detailThickness = useMemo(function () {\n    var result = 0;\n\n    if (detail) {\n      charts.forEach(function (_, index) {\n        var thickness = chartProps[index].thickness;\n        result = Math.max(result, parseMetricToNum(theme.global.edgeSize[thickness] || thickness));\n      });\n    }\n\n    return result + \"px\";\n  }, [charts, chartProps, detail, theme]);\n  var dateFormats = useMemo(function () {\n    var result = {};\n    var full = axis && axis.x && axis.x.granularity === 'coarse';\n    series.forEach(function (_ref8) {\n      var property = _ref8.property,\n          render = _ref8.render;\n\n      if (!render && data.length > 1 && typeof data[0][property] === 'string') {\n        result[property] = createDateFormat(data[0][property], data[data.length - 1][property], full);\n      }\n    });\n    return result;\n  }, [axis, data, series]); // for ie11, align the spacer Box height to the x-axis height\n\n  useLayoutEffect(function () {\n    if (xRef.current && spacerRef.current) {\n      var rect = xRef.current.getBoundingClientRect();\n      spacerRef.current.style.height = rect.height + \"px\";\n    }\n  }, []);\n\n  var renderValue = function renderValue(serie, dataIndex, valueArg) {\n    var value;\n\n    if (valueArg !== undefined) {\n      if (serie && serie.render) return serie.render(valueArg);\n      value = valueArg;\n    } else {\n      var datum = data[dataIndex];\n      value = datum[serie.property];\n      if (serie && serie.render) return serie.render(value, datum, serie.property);\n    }\n\n    if (serie) {\n      var dateFormat = dateFormats[serie.property];\n      if (dateFormat) return dateFormat(new Date(value));\n      if (serie.prefix) value = \"\" + serie.prefix + value;\n      if (serie.suffix) value = \"\" + value + serie.suffix;\n    }\n\n    return value;\n  }; // TODO: revisit how x/y axis are hooked up to charts and series\n\n\n  var xAxisElement = axis && axis.x && chartProps.length ? /*#__PURE__*/React.createElement(XAxis, {\n    ref: xRef,\n    axis: axis,\n    chartProps: chartProps,\n    data: data,\n    renderValue: renderValue,\n    serie: axis.x.property && getPropertySeries(axis.x.property)\n  }) : null;\n  var yAxisElement = axis && axis.y && chartProps.length ? /*#__PURE__*/React.createElement(YAxis, {\n    axis: axis,\n    chartProps: chartProps,\n    pad: pad,\n    renderValue: renderValue,\n    serie: axis.y.property && getPropertySeries(axis.y.property)\n  }) : null;\n  var stackFill = useMemo(function () {\n    if (size === 'fill' || size && size.width === 'fill' && size.height === 'fill') return true;\n    if (size && size.width === 'fill') return 'horizontal';\n    if (size && size.height === 'fill') return 'vertical';\n    return undefined;\n  }, [size]);\n  var guidingChild = useMemo(function () {\n    var result = 0;\n    if (guide && guide.x) result += 1;\n    if (guide && guide.y) result += 1;\n    return result;\n  }, [guide]);\n  var stackElement = /*#__PURE__*/React.createElement(Stack, {\n    gridArea: \"charts\",\n    guidingChild: guidingChild,\n    fill: stackFill\n  }, guide && guide.x && /*#__PURE__*/React.createElement(XGuide, {\n    guide: guide,\n    pad: pad\n  }), guide && guide.y && /*#__PURE__*/React.createElement(YGuide, {\n    guide: guide,\n    pad: pad\n  }), charts.map(function (_ref9, i) {\n    var prop = _ref9.property,\n        type = _ref9.type,\n        x = _ref9.x,\n        y = _ref9.y,\n        chartRest = _objectWithoutPropertiesLoose(_ref9, _excluded2);\n\n    if (type === 'bars') {\n      // reverse to ensure area Charts are stacked in the right order\n      return prop.map(function (cProp, j) {\n        var pProp = cProp.property || cProp;\n        return /*#__PURE__*/React.createElement(Chart // eslint-disable-next-line react/no-array-index-key\n        , _extends({\n          key: j // when property name isn't valid, send empty array\n          ,\n          values: chartValues[i][j] || [],\n          overflow: true\n        }, seriesStyles[pProp], chartProps[i], chartRest, {\n          type: \"bar\",\n          size: size,\n          pad: pad\n        }));\n      }).reverse();\n    }\n\n    return /*#__PURE__*/React.createElement(Chart // eslint-disable-next-line react/no-array-index-key\n    , _extends({\n      key: i,\n      values: chartValues[i],\n      overflow: true\n    }, seriesStyles[prop], chartProps[i], chartRest, {\n      type: type,\n      size: size,\n      pad: pad\n    }));\n  }), detail && /*#__PURE__*/React.createElement(Detail, {\n    activeProperty: activeProperty,\n    axis: axis,\n    data: data,\n    series: series,\n    seriesStyles: seriesStyles,\n    renderValue: renderValue,\n    thickness: detailThickness\n  }));\n  var legendElement = legend ? /*#__PURE__*/React.createElement(Legend, {\n    series: series,\n    seriesStyles: seriesStyles,\n    activeProperty: activeProperty,\n    setActiveProperty: setActiveProperty\n  }) : null; // IE11\n\n  if (!Grid.available) {\n    var _content = stackElement;\n\n    if (xAxisElement) {\n      _content = /*#__PURE__*/React.createElement(Box, null, _content, xAxisElement);\n    }\n\n    if (yAxisElement) {\n      _content = /*#__PURE__*/React.createElement(Box, {\n        direction: \"row\"\n      }, /*#__PURE__*/React.createElement(Box, null, yAxisElement, /*#__PURE__*/React.createElement(Box, {\n        ref: spacerRef,\n        flex: false\n      })), _content);\n    }\n\n    if (legendElement) {\n      _content = /*#__PURE__*/React.createElement(Box, null, _content, legendElement);\n    }\n\n    return _content;\n  }\n\n  var content = /*#__PURE__*/React.createElement(Grid, _extends({\n    ref: ref,\n    \"aria-label\": a11yTitle,\n    fill: stackFill,\n    columns: ['auto', stackFill === true || stackFill === 'horizontal' ? 'flex' : 'auto'],\n    rows: [stackFill === true || stackFill === 'vertical' ? 'flex' : 'auto', 'auto'],\n    areas: [{\n      name: 'yAxis',\n      start: [0, 0],\n      end: [0, 0]\n    }, {\n      name: 'xAxis',\n      start: [1, 1],\n      end: [1, 1]\n    }, {\n      name: 'charts',\n      start: [1, 0],\n      end: [1, 0]\n    }],\n    gap: gap\n  }, rest), xAxisElement, yAxisElement, stackElement);\n\n  if (legendElement) {\n    content = /*#__PURE__*/React.createElement(Box, {\n      align: \"start\"\n    }, content, legendElement);\n  }\n\n  return content;\n});\nDataChart.displayName = 'DataChart';\nDataChart.propTypes = DataChartPropTypes;\nexport { DataChart };","map":{"version":3,"sources":["C:/Users/백지윤/Desktop/React/mbti/node_modules/grommet/es6/components/DataChart/DataChart.js"],"names":["_excluded","_excluded2","_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","apply","_objectWithoutPropertiesLoose","excluded","sourceKeys","keys","indexOf","React","forwardRef","useContext","useMemo","useRef","useState","ThemeContext","useLayoutEffect","Box","Chart","calcs","calcBounds","Grid","Stack","parseMetricToNum","Detail","Legend","XAxis","YAxis","XGuide","YGuide","createDateFormat","halfPad","heightYGranularity","points","DataChartPropTypes","DataChart","_ref","ref","a11yTitle","_ref$axis","axis","axisProp","_ref$bounds","bounds","boundsProp","chart","_ref$data","data","detail","_ref$gap","gap","guideProp","guide","legend","padProp","pad","seriesProp","series","size","rest","theme","defaultProps","_useState","activeProperty","setActiveProperty","xRef","spacerRef","Array","isArray","filter","s","property","map","getPropertySeries","prop","find","_ref2","charts","slice","c","_ref3","seriesValues","result","forEach","_ref4","d","chartValues","_ref5","opacity","type","totals","cp","aProperty","values","undefined","v","base","_","index","concat","p","color","thickness","x","y","y2","value","aValue","push","t","transform","granularities","medium","steps","coarse","fine","height","date","time","granularity","_result$x$granularity","count","_result$y$granularity","_granularity","chartProps","coarseness","_axis$x$granularity","_axis$y$granularity","_granularity2","chartBounds","mergedValues","__","Math","min","max","alignedBounds","calcValues","seriesStyles","_ref6","point","calcThickness","aspect","props","pColor","colorIndex","pointIndex","seriesStyle","_ref7","horizontal","vertical","detailThickness","global","edgeSize","dateFormats","full","_ref8","render","current","rect","getBoundingClientRect","style","renderValue","serie","dataIndex","valueArg","datum","dateFormat","Date","prefix","suffix","xAxisElement","createElement","yAxisElement","stackFill","width","guidingChild","stackElement","gridArea","fill","_ref9","chartRest","cProp","j","pProp","overflow","reverse","legendElement","available","_content","direction","flex","content","columns","rows","areas","name","start","end","align","displayName","propTypes"],"mappings":"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","sourcesContent":["var _excluded = [\"a11yTitle\", \"axis\", \"bounds\", \"chart\", \"data\", \"detail\", \"gap\", \"guide\", \"legend\", \"pad\", \"series\", \"size\"],\n    _excluded2 = [\"property\", \"type\", \"x\", \"y\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React, { forwardRef, useContext, useMemo, useRef, useState } from 'react';\nimport { ThemeContext } from 'styled-components';\nimport { useLayoutEffect } from '../../utils/use-isomorphic-layout-effect';\nimport { Box } from '../Box';\nimport { Chart, calcs, calcBounds } from '../Chart';\nimport { Grid } from '../Grid';\nimport { Stack } from '../Stack';\nimport { parseMetricToNum } from '../../utils';\nimport { Detail } from './Detail';\nimport { Legend } from './Legend';\nimport { XAxis } from './XAxis';\nimport { YAxis } from './YAxis';\nimport { XGuide } from './XGuide';\nimport { YGuide } from './YGuide';\nimport { createDateFormat, halfPad, heightYGranularity, points } from './utils';\nimport { DataChartPropTypes } from './propTypes'; // DataChart takes a generic data array of objects plus as few properties\n// as possible, and creates a Stack of Charts with x and y axes, a legend,\n// and interactive detail.\n// Much of the code here-in involves the \"few properties\" aspect where we\n// normalize and automatically handle whatever the caller didn't specify.\n\nvar DataChart = /*#__PURE__*/forwardRef(function (_ref, ref) {\n  var a11yTitle = _ref.a11yTitle,\n      _ref$axis = _ref.axis,\n      axisProp = _ref$axis === void 0 ? true : _ref$axis,\n      _ref$bounds = _ref.bounds,\n      boundsProp = _ref$bounds === void 0 ? 'align' : _ref$bounds,\n      chart = _ref.chart,\n      _ref$data = _ref.data,\n      data = _ref$data === void 0 ? [] : _ref$data,\n      detail = _ref.detail,\n      _ref$gap = _ref.gap,\n      gap = _ref$gap === void 0 ? 'small' : _ref$gap,\n      guideProp = _ref.guide,\n      legend = _ref.legend,\n      padProp = _ref.pad,\n      seriesProp = _ref.series,\n      size = _ref.size,\n      rest = _objectWithoutPropertiesLoose(_ref, _excluded);\n\n  var theme = useContext(ThemeContext) || defaultProps.theme; // legend interaction, if any\n\n  var _useState = useState(),\n      activeProperty = _useState[0],\n      setActiveProperty = _useState[1]; // refs used for ie11 not having Grid\n\n\n  var xRef = useRef();\n  var spacerRef = useRef(); // normalize seriesProp to an array of objects, one per property\n\n  var series = useMemo(function () {\n    if (Array.isArray(seriesProp)) return seriesProp.filter(function (s) {\n      return s.property || typeof s === 'string';\n    }).map(function (s) {\n      return typeof s === 'string' ? {\n        property: s\n      } : s;\n    });\n    if (typeof seriesProp === 'string') return [{\n      property: seriesProp\n    }];\n    if (seriesProp) return [seriesProp];\n    return [];\n  }, [seriesProp]);\n\n  var getPropertySeries = function getPropertySeries(prop) {\n    return series.find(function (_ref2) {\n      var property = _ref2.property;\n      return prop === property;\n    });\n  }; // Normalize chart to an array of objects.\n  // Each chart has one or more properties associated with it.\n  // A stacked bar chart has an array of properties.\n  // A point chart can have x, y, thickness, and color each driven\n  // by a separate property.\n\n\n  var charts = useMemo(function () {\n    if (!chart) {\n      if (series.length === 1) return series.filter(function (s) {\n        return s.property;\n      }).map(function (s) {\n        return {\n          property: s.property\n        };\n      }); // if we have more than one property, we'll use the first for\n      // the x-axis and we'll plot the rest\n\n      return series.slice(1).map(function (s) {\n        return {\n          property: s.property\n        };\n      });\n    }\n\n    if (Array.isArray(chart)) return chart.map(function (c) {\n      return typeof c === 'string' ? {\n        property: c\n      } : c;\n    }).filter(function (_ref3) {\n      var property = _ref3.property;\n      return property;\n    });\n    if (typeof chart === 'string') return [{\n      property: chart\n    }];\n    if (chart) return [chart];\n    return [];\n  }, [chart, series]); // map the series property values into their own arrays\n\n  var seriesValues = useMemo(function () {\n    var result = {};\n    series.forEach(function (_ref4) {\n      var property = _ref4.property;\n      result[property] = data.map(function (d) {\n        return d[property];\n      });\n    });\n    return result;\n  }, [data, series]); // Setup the values property for each chart.\n  // The index into 'charts' can be used to index into 'chartValues'.\n\n  var chartValues = useMemo(function () {\n    return charts.map(function (_ref5) {\n      var opacity = _ref5.opacity,\n          property = _ref5.property,\n          type = _ref5.type;\n\n      if (property) {\n        if (Array.isArray(property)) {\n          // A range chart or a stacked bar chart have multiple properties.\n          // In this case, this returns an array of values,\n          // one per property.\n          if (type === 'bars') {\n            // Further down, where we render, each property is rendered\n            // using a separate Chart component and the values are stacked\n            // such that they line up appropriately.\n            var totals = [];\n            return property.map(function (cp) {\n              // handle object or string\n              var aProperty = cp.property || cp;\n              var values = seriesValues[aProperty];\n              if (!values) return undefined; // property name isn't valid\n\n              return values.map(function (v, i) {\n                var base = totals[i] || 0;\n                totals[i] = base + v;\n                return [i, base, base + v];\n              });\n            });\n          }\n\n          return data.map(function (_, index) {\n            return [index].concat(property.map(function (p) {\n              return seriesValues[p] ? seriesValues[p][index] : data[index][p];\n            }));\n          });\n        }\n\n        if (typeof property === 'object') {\n          // When 'property' is an array, the keys of this array indicate\n          // which property drives which part of the rendered Chart.\n          var color = property.color,\n              thickness = property.thickness,\n              x = property.x,\n              y = property.y,\n              y2 = property.y2;\n          return seriesValues[x].map(function (value, index) {\n            var aValue = {\n              value: [value]\n            };\n            aValue.value.push(seriesValues[y][index]);\n            if (y2) aValue.value.push(seriesValues[y2][index]);\n\n            if (thickness) {\n              var t = seriesValues[thickness.property || thickness][index];\n              aValue.thickness = thickness.transform ? thickness.transform(t) : t;\n            }\n\n            if (color) {\n              var c = seriesValues[color.property || color][index];\n              aValue.color = color.transform ? color.transform(c) : c;\n            }\n\n            if (opacity) aValue.opacity = opacity;\n            return aValue;\n          });\n        }\n\n        return seriesValues[property];\n      }\n\n      return undefined;\n    });\n  }, [charts, data, seriesValues]); // map granularities to work well with the number of data points we have\n\n  var granularities = useMemo(function () {\n    var medium; // determine a good medium granularity that will align well with the\n    // length of the data\n\n    var steps = data.length - 1; // special case property driven point charts\n\n    if (charts[0] && typeof charts[0].property === 'object') medium = 3;else if (steps < 4) medium = data.length;else if (steps === 4) medium = 3;else if (steps % 4 === 0) medium = 5;else if (steps % 3 === 0) medium = 4;else if (steps % 2 === 0) medium = 3;else medium = 2;\n    return {\n      x: {\n        coarse: 2,\n        fine: data.length,\n        medium: medium\n      },\n      y: _extends({}, heightYGranularity[size && size.height || 'small'] || {\n        fine: 5,\n        medium: 3\n      }, {\n        coarse: 2\n      })\n    };\n  }, [charts, data.length, size]); // normalize axis to objects, convert granularity to a number\n\n  var axis = useMemo(function () {\n    if (!axisProp) return undefined;\n    var result = {};\n    if (axisProp === true || axisProp.x === true) result.x = {};\n    if (axisProp === true || axisProp.y === true) result.y = {};\n    if (!result.x && axisProp.x) result.x = typeof axisProp.x === 'string' ? {\n      property: axisProp.x\n    } : _extends({}, axisProp.x);\n    if (!result.y && axisProp.y) result.y = typeof axisProp.y === 'string' ? {\n      property: axisProp.y\n    } : _extends({}, axisProp.y);\n\n    if (result.x) {\n      if (!result.x.property) {\n        // see if we have a point chart that has an x property\n        if (data && data[0]) {\n          if (data[0].date) result.x.property = 'date';else if (data[0].time) result.x.property = 'time';\n        }\n      }\n\n      if (!result.x.granularity) result.x.granularity = 'coarse';\n    }\n\n    if (result.y) {\n      if (!result.y.property && charts[0]) // see if we have a point chart that has an x property\n        result.y.property = charts[0].property.y || charts[0].property;\n      if (!result.y.granularity) result.y.granularity = 'coarse';\n    } // calculate number of entries based on granularity\n\n\n    if (result.x) {\n      var _result$x$granularity = result.x.granularity,\n          granularity = _result$x$granularity === void 0 ? 'coarse' : _result$x$granularity;\n      result.x.count = granularities.x[granularity];\n    }\n\n    if (result.y) {\n      var _result$y$granularity = result.y.granularity,\n          _granularity = _result$y$granularity === void 0 ? 'coarse' : _result$y$granularity;\n\n      result.y.count = granularities.y[_granularity];\n    }\n\n    return result;\n  }, [axisProp, data, charts, granularities]); // calculate axis, bounds, and thickness for each chart\n\n  var chartProps = useMemo(function () {\n    var steps = [];\n    var coarseness = [undefined, 5];\n\n    if (axis && axis.x) {\n      var _axis$x$granularity = axis.x.granularity,\n          granularity = _axis$x$granularity === void 0 ? 'coarse' : _axis$x$granularity;\n      steps[0] = granularities.x[granularity] - 1;\n    } else steps[0] = data.length - 1;\n\n    if (axis && axis.y) {\n      var _axis$y$granularity = axis.y.granularity,\n          _granularity2 = _axis$y$granularity === void 0 ? 'coarse' : _axis$y$granularity;\n\n      steps[1] = granularities.y[_granularity2] - 1;\n    } else steps[1] = 1;\n\n    var chartBounds = chartValues.map(function (_, index) {\n      if (charts[index].type === 'bars') {\n        // merge values for bars case\n        var mergedValues = chartValues[index][0].slice(0);\n        chartValues[index].slice(1).filter(function (values) {\n          return values;\n        }) // property name isn't valid\n        .forEach(function (values) {\n          mergedValues = mergedValues.map(function (__, i) {\n            return [i, Math.min(mergedValues[i][1], values[i][1]), Math.max(mergedValues[i][2], values[i][2])];\n          });\n        });\n        return calcBounds(mergedValues, {\n          coarseness: coarseness,\n          steps: steps\n        });\n      } // if this is a data driven x chart, set coarseness for x\n\n\n      return calcBounds(chartValues[index], {\n        coarseness: charts[index].property.x ? [5, 5] : coarseness,\n        steps: steps\n      });\n    });\n\n    if (boundsProp === 'align' && chartBounds.length) {\n      var alignedBounds = [].concat(chartBounds[0]);\n      chartBounds.forEach(function (bounds) {\n        alignedBounds[0][0] = Math.min(alignedBounds[0][0], bounds[0][0]);\n        alignedBounds[0][1] = Math.max(alignedBounds[0][1], bounds[0][1]);\n        alignedBounds[1][0] = Math.min(alignedBounds[1][0], bounds[1][0]);\n        alignedBounds[1][1] = Math.max(alignedBounds[1][1], bounds[1][1]);\n      });\n      chartBounds = chartBounds.map(function () {\n        return alignedBounds;\n      });\n    }\n\n    return chartValues.map(function (values, index) {\n      var calcValues = charts[index].type === 'bars' ? values[0] : values;\n      return calcs(calcValues, {\n        bounds: chartBounds[index],\n        steps: steps\n      });\n    });\n  }, [axis, boundsProp, charts, chartValues, data, granularities]); // normalize how we style data properties for use by Legend and Detail\n\n  var seriesStyles = useMemo(function () {\n    var result = {}; // start from what we were explicitly given\n\n    charts.forEach(function (_ref6, index) {\n      var color = _ref6.color,\n          point = _ref6.point,\n          property = _ref6.property,\n          thickness = _ref6.thickness,\n          type = _ref6.type;\n      var calcThickness = chartProps[index].thickness;\n\n      if (typeof property === 'object' && !Array.isArray(property)) {\n        // data driven point chart\n        Object.keys(property).forEach(function (aspect) {\n          var prop = property[aspect];\n          if (!result[prop.property || prop]) result[prop.property || prop] = {\n            aspect: aspect\n          };\n        });\n      } else {\n        var props = Array.isArray(property) ? property : [property];\n        props.forEach(function (prop) {\n          var p = prop.property || prop;\n          var pColor = prop.color || color;\n          if (!result[p]) result[p] = {};\n          if (pColor && !result[p].color) result[p].color = pColor;\n          if (point && !result[p].point) result[p].point = point;else if (type === 'point') result[p].point = false;\n          if ((thickness || calcThickness) && !result[p].thickness) result[p].thickness = thickness || calcThickness;\n        });\n      }\n    }); // set color for any non-aspect properties we don't have one for yet\n\n    var colorIndex = 0;\n    var pointIndex = 0;\n    Object.keys(result).forEach(function (key) {\n      var seriesStyle = result[key];\n\n      if (!seriesStyle.aspect && !seriesStyle.color) {\n        seriesStyle.color = \"graph-\" + colorIndex;\n        colorIndex += 1;\n      } // set opacity if it isn't set and this isn't the active property\n\n\n      if (activeProperty !== undefined && activeProperty !== key) {\n        seriesStyle.opacity = 'medium';\n      }\n\n      if (seriesStyle.point === false) {\n        seriesStyle.point = points[pointIndex];\n        pointIndex += 1;\n      }\n    });\n    return result;\n  }, [activeProperty, charts, chartProps]); // normalize guide\n\n  var guide = useMemo(function () {\n    if (!guideProp) return undefined;\n    var result;\n\n    if (guideProp === true) {\n      result = {\n        x: {},\n        y: {}\n      };\n    } else {\n      result = {};\n      if (guideProp.x) result.x = _extends({}, guideProp.x);\n      if (guideProp.y) result.y = _extends({}, guideProp.y);\n    } // set counts\n\n\n    if (result.x) {\n      // if no granularity and axis, align count with axis\n      if (!result.x.granularity && axis && axis.x) result.x.count = axis.x.count;\n      if (!result.x.count) result.x.count = granularities.x[result.x.granularity || 'coarse'];\n    }\n\n    if (result.y) {\n      // if no granularity and axis, align count with axis\n      if (!result.y.granularity && axis && axis.y) result.y.count = axis.y.count;\n      if (!result.y.count) result.y.count = granularities.y[result.y.granularity || 'coarse'];\n    }\n\n    return result;\n  }, [axis, granularities, guideProp]); // set the pad to half the thickness, based on the chart types\n\n  var pad = useMemo(function () {\n    if (padProp !== undefined) return padProp;\n    var result = {};\n    charts.forEach(function (_ref7, index) {\n      var type = _ref7.type;\n      var thickness = chartProps[index].thickness;\n      result.horizontal = halfPad[thickness];\n      if (type && type !== 'bar') result.vertical = halfPad[thickness];\n    });\n    return result;\n  }, [chartProps, charts, padProp]); // The thickness of the Detail segments. We need to convert to numbers\n  // to be able to compare across charts where some might be using T-shirt\n  // labels and others might be pixel values.\n\n  var detailThickness = useMemo(function () {\n    var result = 0;\n\n    if (detail) {\n      charts.forEach(function (_, index) {\n        var thickness = chartProps[index].thickness;\n        result = Math.max(result, parseMetricToNum(theme.global.edgeSize[thickness] || thickness));\n      });\n    }\n\n    return result + \"px\";\n  }, [charts, chartProps, detail, theme]);\n  var dateFormats = useMemo(function () {\n    var result = {};\n    var full = axis && axis.x && axis.x.granularity === 'coarse';\n    series.forEach(function (_ref8) {\n      var property = _ref8.property,\n          render = _ref8.render;\n\n      if (!render && data.length > 1 && typeof data[0][property] === 'string') {\n        result[property] = createDateFormat(data[0][property], data[data.length - 1][property], full);\n      }\n    });\n    return result;\n  }, [axis, data, series]); // for ie11, align the spacer Box height to the x-axis height\n\n  useLayoutEffect(function () {\n    if (xRef.current && spacerRef.current) {\n      var rect = xRef.current.getBoundingClientRect();\n      spacerRef.current.style.height = rect.height + \"px\";\n    }\n  }, []);\n\n  var renderValue = function renderValue(serie, dataIndex, valueArg) {\n    var value;\n\n    if (valueArg !== undefined) {\n      if (serie && serie.render) return serie.render(valueArg);\n      value = valueArg;\n    } else {\n      var datum = data[dataIndex];\n      value = datum[serie.property];\n      if (serie && serie.render) return serie.render(value, datum, serie.property);\n    }\n\n    if (serie) {\n      var dateFormat = dateFormats[serie.property];\n      if (dateFormat) return dateFormat(new Date(value));\n      if (serie.prefix) value = \"\" + serie.prefix + value;\n      if (serie.suffix) value = \"\" + value + serie.suffix;\n    }\n\n    return value;\n  }; // TODO: revisit how x/y axis are hooked up to charts and series\n\n\n  var xAxisElement = axis && axis.x && chartProps.length ? /*#__PURE__*/React.createElement(XAxis, {\n    ref: xRef,\n    axis: axis,\n    chartProps: chartProps,\n    data: data,\n    renderValue: renderValue,\n    serie: axis.x.property && getPropertySeries(axis.x.property)\n  }) : null;\n  var yAxisElement = axis && axis.y && chartProps.length ? /*#__PURE__*/React.createElement(YAxis, {\n    axis: axis,\n    chartProps: chartProps,\n    pad: pad,\n    renderValue: renderValue,\n    serie: axis.y.property && getPropertySeries(axis.y.property)\n  }) : null;\n  var stackFill = useMemo(function () {\n    if (size === 'fill' || size && size.width === 'fill' && size.height === 'fill') return true;\n    if (size && size.width === 'fill') return 'horizontal';\n    if (size && size.height === 'fill') return 'vertical';\n    return undefined;\n  }, [size]);\n  var guidingChild = useMemo(function () {\n    var result = 0;\n    if (guide && guide.x) result += 1;\n    if (guide && guide.y) result += 1;\n    return result;\n  }, [guide]);\n  var stackElement = /*#__PURE__*/React.createElement(Stack, {\n    gridArea: \"charts\",\n    guidingChild: guidingChild,\n    fill: stackFill\n  }, guide && guide.x && /*#__PURE__*/React.createElement(XGuide, {\n    guide: guide,\n    pad: pad\n  }), guide && guide.y && /*#__PURE__*/React.createElement(YGuide, {\n    guide: guide,\n    pad: pad\n  }), charts.map(function (_ref9, i) {\n    var prop = _ref9.property,\n        type = _ref9.type,\n        x = _ref9.x,\n        y = _ref9.y,\n        chartRest = _objectWithoutPropertiesLoose(_ref9, _excluded2);\n\n    if (type === 'bars') {\n      // reverse to ensure area Charts are stacked in the right order\n      return prop.map(function (cProp, j) {\n        var pProp = cProp.property || cProp;\n        return /*#__PURE__*/React.createElement(Chart // eslint-disable-next-line react/no-array-index-key\n        , _extends({\n          key: j // when property name isn't valid, send empty array\n          ,\n          values: chartValues[i][j] || [],\n          overflow: true\n        }, seriesStyles[pProp], chartProps[i], chartRest, {\n          type: \"bar\",\n          size: size,\n          pad: pad\n        }));\n      }).reverse();\n    }\n\n    return /*#__PURE__*/React.createElement(Chart // eslint-disable-next-line react/no-array-index-key\n    , _extends({\n      key: i,\n      values: chartValues[i],\n      overflow: true\n    }, seriesStyles[prop], chartProps[i], chartRest, {\n      type: type,\n      size: size,\n      pad: pad\n    }));\n  }), detail && /*#__PURE__*/React.createElement(Detail, {\n    activeProperty: activeProperty,\n    axis: axis,\n    data: data,\n    series: series,\n    seriesStyles: seriesStyles,\n    renderValue: renderValue,\n    thickness: detailThickness\n  }));\n  var legendElement = legend ? /*#__PURE__*/React.createElement(Legend, {\n    series: series,\n    seriesStyles: seriesStyles,\n    activeProperty: activeProperty,\n    setActiveProperty: setActiveProperty\n  }) : null; // IE11\n\n  if (!Grid.available) {\n    var _content = stackElement;\n\n    if (xAxisElement) {\n      _content = /*#__PURE__*/React.createElement(Box, null, _content, xAxisElement);\n    }\n\n    if (yAxisElement) {\n      _content = /*#__PURE__*/React.createElement(Box, {\n        direction: \"row\"\n      }, /*#__PURE__*/React.createElement(Box, null, yAxisElement, /*#__PURE__*/React.createElement(Box, {\n        ref: spacerRef,\n        flex: false\n      })), _content);\n    }\n\n    if (legendElement) {\n      _content = /*#__PURE__*/React.createElement(Box, null, _content, legendElement);\n    }\n\n    return _content;\n  }\n\n  var content = /*#__PURE__*/React.createElement(Grid, _extends({\n    ref: ref,\n    \"aria-label\": a11yTitle,\n    fill: stackFill,\n    columns: ['auto', stackFill === true || stackFill === 'horizontal' ? 'flex' : 'auto'],\n    rows: [stackFill === true || stackFill === 'vertical' ? 'flex' : 'auto', 'auto'],\n    areas: [{\n      name: 'yAxis',\n      start: [0, 0],\n      end: [0, 0]\n    }, {\n      name: 'xAxis',\n      start: [1, 1],\n      end: [1, 1]\n    }, {\n      name: 'charts',\n      start: [1, 0],\n      end: [1, 0]\n    }],\n    gap: gap\n  }, rest), xAxisElement, yAxisElement, stackElement);\n\n  if (legendElement) {\n    content = /*#__PURE__*/React.createElement(Box, {\n      align: \"start\"\n    }, content, legendElement);\n  }\n\n  return content;\n});\nDataChart.displayName = 'DataChart';\nDataChart.propTypes = DataChartPropTypes;\nexport { DataChart };"]},"metadata":{},"sourceType":"module"}